# Machine-learning-project
Class Classification (with. raspi &amp; arduino &amp; CNN)

이미지 분류는 CNN으로 학습.

아두이노는 라즈베리파이가 유선 시리얼 통신으로 제어.

*작동 시나리오

가정

이미지 분류를 위해 이미 학습을 수행했고 수행한 결과값을 저장해 놓았음.

1. 라즈베리파이는 사진을 찍고 해당 사진 PC에 전송.
2. PC는 전송 받은 이미지를 이미 학습한 데이터를 토대로 어떤 이미지인지 확인.
3. 라벨에 따라 저장된 재배 환경 라즈베리파이로 전송.
4. 라즈베리파이는 아두이노로부터 현재 사육환경 데이터를 전송받고, 아두이노 데이터와 라즈베리파이로부터 데이터를 비교. 
5. 만약 비교한 값이 오차범위를 벗어난다면, 사육환경을 유지하도록 시리얼 통신으로 아두이노에게 제어 신호 전송.
6. 1~5의 과정 반복.

사용 기기 및 센서

- 라즈베리파이 * 1
- 아두이노 * 1
- PC * 1
- 온습도 센서(DHT 11) * 1
- 토양 수분 센서 * 1
- 물 펌프 * 1
- Pi Cam * 1
- PVC 튜브 * 1
- 식물 생장용 LED * 1
- 습도 조절 FAN * 1
- 온열 패드 * 2
- 1.5V 건전지 * 4
- 트랜지스터 * 3
- 릴레이 * 1
- 220V 파워 * 1

상세 사용 내역

- 라즈베리파이
Pi Cam으로 식물의 성장 상태를 사진으로 기록하고, 해당 사진을 PC로 전송한다. 
PC에서 전송받은 해당 식물의 최적의 사육 환경을 아두이노가 시리얼 통신으로 수집한 사육 환경과 비교. 
값이 다르다면 최적의 사육 환경을 유지하도록 아두이노에게 제어 신호를 보낸다.

- 아두이노
각종 센서를 통해 현재 사육장의 환경 데이터를 수집하고 시리얼 통신(UART)으로 라즈베리파이에 전송한다.
라즈베리파이로부터 전달받은 제어신호를 통해 사육 환경을 유지한다.

- PC
파이썬과 케라스로 CNN을 구성하고 백합, 장미 이미지와 머신러닝으로 백합, 장미, 그 이외의 꽃을 구분할 수 있는 파이썬 코드를 실행하는 주체.
라즈베리로부터 TCP를 사용하여 식물 이미지를 전달 받고, 해당 이미지를 이미 학습한 데이터를 토대로 분류하고 분류된 작물의 최적의 환경을 TCP통신으로 라즈베리파이에 전송한다.

- 온습도 센서(DHT 11)
- 토양 수분 센서
- 조도 센서
- 물 펌프
- 식물 생장용 LED 
- 습도 조절 FAN 
- 온열 패드
아두이노에서 환경데이터를 수집하고, 사육환경을 유지하기 위해 사용하는 센서와 모듈.

- Pi Cam
라즈베리파이가 사진을 찍기 위해 사용하는 모듈.

- PVC 튜브
펌프의 물을 고르게 뿌려주기 위한 모듈.

- 1.5V 건전지
온열패드, 습도 조절 FAN, 물 펌프 등의 제어 장치를 구동하기 위한 전력원.

- 트랜지스터
제어 장치를 선택적으로 구동하기 위해 사용된 전자기기.

- 릴레이
식물 생장용 LED를 조명이 어두워졌을 때만 키기 위해 사용하는 아두이노 모듈.

아두이노에서 UP 신호를 보내면 220V를 흐르게 만들 수 있다.

- 220V 파워 
식물 생장용 LED를 위한 전력원.

릴레이와 연결하여 사용됨.

CNN이란?

Convolution Neural Network의 약자.

CNN, RNN, GAN등의 Deep learning에서 쓰이는 신경망 중 하나.

이전에 쓰이던 신경망으로 Fully Connected Layer가 있음.

(이전 레이어의 모든 노드가 다음 레이어의 모든 노드에 연결된 레이어를 Fully Connected Layer(FC Layer)라
고 합니다. FC Layer를 Dense Layer라 함.)

특징으로 이미지의 특징을 추출하는 부분과 클래스를 분류하는 부분으로 나눌 수 있다.

특징 추출 -> Convolution Layer(필수),Pooling Layer(선택)

-----------------Flattend Layer 존재---------------------

클래스 분류 -> Fully Connected Layer

Convoultion Layer란?

입력 데이터에 필터를 적용 후 활성화 함수를 반영하는 필수 요소.

Flatten Layer란?

이미지 형태의 데이터를 배열로 만드는 요소

Fully Connected Layer란?

이미지 분류를 위해 CNN 마지막에 들어가는 요소.

*추가로 알아두면 좋은 계층

Dropout layer

해당 계층은 신경망이 학습중일때, 랜덤하게 뉴런을 꺼서 학습을 방해함으로써, 학습이 학습용 데이터에 치우치는 과적합 현상을 방지할 때 사용한다.

CNN 작동 과정

입력데이터는 Convoultio Layer를 통해 정해진 필터가 순회하며 합성곱을 계산.

계산 결과를 이용하여 Feature map을 생성.(3채널 이미지의 경우 각 채널별 합성곱의 합을 Feature map으로)

Feature map에 활성 함수(ReLu같은)를 적용하여 Activation map 생성.

출력 데이터의 크기를 줄이거나 특정 데이터를 강조하기 위해 Pooling Layer 사용.(max,average,min pooling)

위 과정을 여러번 거침.

Flatten Layer로 Convolution 형태의 데이터를 형태 변환.

Softmax Layer를 거쳐서 최종 결과 도출.(장미일 확률을 0~1사이의 값으로 표시해주기 위해 사용.)


! why use CNN?

CNN이 사람이나 동물 인식에 탁월한 성능을 나타냄.

Fully Connected 신경망으로 학습을 진행할 경우, 데이터 셋이 더 많이 필요하고 시간도 오래걸림.

구글의 알파고가 사용한 신경망으로도 유명하기 때문에 사용한 경향도 있음.


! why use Keras?

Keras는 tensorflow같은 백엔드 위에 구축되어 있는 하이 레벨 패키지 (그냥 라이브러리쯤으로 이해)

tensorflow를 사용해서 구축할 경우 1000줄 정도 필요한 구성을 Keras를 이용하면 더 짧게 구성할 수 있기 때문에 Keras를 사용했다.

애초에 Keras 자체가 머신러닝 초심자에게 추천하는 프레임워크이기 때문에 사용한 것도 있다.

